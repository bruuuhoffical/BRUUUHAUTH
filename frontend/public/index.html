<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BRUUUHAUTH</title>
  <link rel="stylesheet" href="../dist/output.css" />
  <link rel="stylesheet" href="output.css" />
  <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body class="bg-gray-900 text-white flex flex-col items-center justify-center h-screen gap-4">
  <h1 class="text-4xl font-bold mb-6">Welcome to BRUUUHAUTH</h1>

  <button onclick="loginWith('github')" class="bg-white text-black px-4 py-2 rounded">Login with GitHub</button>
  <button onclick="loginWith('discord')" class="bg-indigo-500 text-white px-4 py-2 rounded">Login with Discord</button>
  <button onclick="loginWith('google')" class="bg-red-500 text-white px-4 py-2 rounded">Login with Google</button>
</body>

<script type="module">
  import { Client, Account } from "https://cdn.jsdelivr.net/npm/appwrite@13.0.1/+esm";

  const client = new Client()
    .setEndpoint("https://cloud.appwrite.io/v1")
    .setProject("bruuuhauth");

  const account = new Account(client);

  window.loginWith = (provider) => {
    account.createOAuth2Session(provider, "https://bruuuhauth.vercel.app");
  };

  try {
    const user = await account.get();
    document.body.innerHTML = `
      <div class="flex flex-col items-center justify-center h-screen bg-gray-900 text-white">
        <h1 class="text-3xl font-bold mb-4">Welcome, ${user.name || user.email} ðŸ‘‹</h1>
        <p class="mb-6 text-gray-400">Email: ${user.email}</p>
        <button id="logoutBtn" class="bg-red-500 px-4 py-2 rounded text-white">Logout</button>
      </div>
    `;

    document.getElementById("logoutBtn").addEventListener("click", async () => {
      await account.deleteSessions();
      location.reload();
    });
  } catch (err) {
    console.log("No user session yet. Waiting for login.");
  }
</script>



</html>
